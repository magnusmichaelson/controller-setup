
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
  </head>
  <body>
      <pre id="test">
Controller not detected.
    </div>
  </body>

<script>

var controllerActive = false;

var rAF = window.mozRequestAnimationFrame ||
  window.webkitRequestAnimationFrame ||
  window.requestAnimationFrame;

var rAFStop = window.mozCancelRequestAnimationFrame ||
  window.webkitCancelRequestAnimationFrame ||
  window.cancelRequestAnimationFrame;

window.addEventListener("gamepadconnected", function() {
    controllerActive = true;
});
window.addEventListener("gamepaddisconnected", function() {
    controllerActive = true;
});



gameLoop();

function gameLoop() {
    if (controllerActive){
        gamepadStart();
    }
    var start = rAF(gameLoop);
};

function gamepadStart(){
    if (navigator.platform == "MacIntel"){
        gamepadMac();
    } else {
        gamepadUnknown();
    }
}

function gamepadMac(){
    var gamepadData = [];
    var valid = false;
    var gamePad = navigator.getGamepads()[0];
    if (gamePad.hasOwnProperty("axes") && gamePad.hasOwnProperty("buttons")){
        var valid = true;
        if (gamePad["axes"].length > 3){
            gamepadData[0] = gamePad.axes[0];
            gamepadData[1] = gamePad.axes[1];
            gamepadData[2] = gamePad.axes[2];
            gamepadData[3] = gamePad.axes[3];
        }
        else {
            valid = false;
        }
        if (gamePad["buttons"].hasOwnProperty(7)){
            gamepadData[4] = gamePad.buttons[7].value;
        }
        else {
            valid = false;
        }
        if (gamePad["buttons"].hasOwnProperty(6)){
            gamepadData[5] = gamePad.buttons[6].value;
        }
        else {
            valid = false;
        }
        if (gamePad["buttons"].hasOwnProperty(4)){
            gamepadData[6] = gamePad.buttons[4].value;
        }
        else {
            valid = false;
        }
        if (gamePad["buttons"].hasOwnProperty(5)){
            gamepadData[7] = gamePad.buttons[5].value;
        }
        else {
            valid = false;
        }
        if (valid){
            gamepadDisplay(gamepadData,gamePad);
        }
    } 
}

function gamepadUnknown(){
    var output = document.getElementById("test");
    output.innerHTML = "This controller/OS is not recognized";
}

function gamepadDisplay(gamepadData,gamePad){
    var output = document.getElementById("test");
    output.innerHTML = "";
    output.innerHTML += "asdasdasLeft stick horizontal  " + gamepadData[0] + "<br/>";
    output.innerHTML += "Left stick vertical    " + gamepadData[1] + "<br/>";
    output.innerHTML += "Right stick horizontal " + gamepadData[2] + "<br/>";
    output.innerHTML += "Right stick vertical   " + gamepadData[3] + "<br/>";
    output.innerHTML += "Up                     " + gamepadData[4] + "<br/>";
    output.innerHTML += "Down                   " + gamepadData[5] + "<br/>";
    output.innerHTML += "Left click             " + gamepadData[6] + "<br/>";
    output.innerHTML += "Right click            " + gamepadData[7] + "<br/>";
    output.innerHTML += "<br/>";
    output.innerHTML += navigator.platform + "<br/>";
    output.innerHTML += "<br/>";
    for (var axisCount = 0; axisCount < gamePad["axes"].length; axisCount++){
        output.innerHTML += "axis " + axisCount + " " + gamePad["axes"][axisCount] + "<br/>";
        console.log(gamePad["axes"][axisCount])
    }
    Object.keys(gamePad["buttons"]).forEach(function(buttonKey){
        output.innerHTML += "button " + buttonKey + " " + JSON.stringify(gamePad["buttons"][buttonKey]["value"]) + "<br/>";
    })
}

</script>
</html>